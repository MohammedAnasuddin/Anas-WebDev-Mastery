# Async Execution

JS employs single thread synchronous execution i.e., executes the next line only if current line is completely executed.

## Execution of JS Code

### Synchronous Code

- Initially, a global execution context is create in the call stack and code is place in there

- If a function call is encountered then a new Function Execution Context is created and code inside the function will execute in this new context.

- After function returns a value the function Execution context is erased from the Callstack

- If the last line of JS code is execute Global Execution Context is also erased from the Callstack.

### Asynchronous Code

- To perform all the asynchronous tasks we need to connect to the external resources (OS)

- NodeJS gives the super powers to the JS Engine to interact with the External resources. (OS) 

- NodeJS gives these powers via a library `libuv`

- `libuv` interacts with external resources behalf of JS Engine

- JS Engine transfers async tasks to `libuv` to handle.

> `libuv` is written in C language, since C language is a good choice to interact with OS , (Interaction with OS is essential to perform async tasks)

#### Execution of Async Code with v8 and libuv

1. Async Code is encountered , JS Engine offloads it to libuv

2. libuv stores the task and the corresponding callback function.

3. JS Engine moves to the next line. 

4. libuv runs the tasks asynchronously

5. If a async tasks gets completed libuv places the callback corresponding to the tasks in the Callstack

6. A new function execution will be created for the Callback and the function is executed.

> Hence Proved, NODEJS is NON-blocking it does not holds/blocks the single thread execution when async operations are encountered, it offloads them to libuv and continues the execution.
> 
> NodeJS is quoted as Async I/O by it;s ability to seamlessly handle Async tasks.

![](..\Diagrams\libuv_Execution%20of%20Async%20Tasks.png)

## Synchronous Functions of Internal Modules

NodeJS Internal Modules provides Synchronous version of their functions which are append by "Sync" in there name. Eg: readFileSync

These functions run as Synchronous i.e., they block the execution of main thread. 

> Do not use them, since they block the main thread which may effect the other operations execution.

These Sync Functions will never have a Callback since these executed on main thread itself.

> ### What's the logo of `libuv`?
> 
> It's a *Unicorn Velociraptor*  it was decided as mnemonic to describe the "uv" in the libuv.  libuv doesn't have any meaning but they choose these both animals because:
> 
> `u-Unicorn`: Signifies *Universal* , libuv can work across multiple platforms.
> 
> `v-Velociraptor`: Signifies *Velocity*, libuv delivers high-speed performance.
